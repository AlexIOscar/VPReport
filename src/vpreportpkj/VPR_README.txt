
										VPReport
						
__________________________________________________________________________________________________
1. Назначение

Программа предназначается для генерации сводной информации по сырым выгрузкам,
получаемым с оборудования Vernet Beringher.

__________________________________________________________________________________________________
2. Главное окно

Отображается при запуске программы.

Директория-источник - адрес директории, из которой будут взяты все файлы выгрузок, и из них
                      будет составлена пара отчетов (общий и посменный). Помимо файлов, лежащих
					  непосредственно в директории, будет выполнен обход всех подкаталогов на всю
					  глубину, и захвачены также выгрузки оттуда. Производится захват только файлов
					  с резширением .txt, остальные - игнорируются. Если хотя бы в одном файле в 
					  указанной директории в какой-либо строке форматирование данных не будет
					  соответствовать формату выгрузки VB, вся попытка построения отчета будет
					  отменена, а пользователь уведомлен об этом сообщением "Wrong line format...".
					  Если в выбранной директории не содержится ни одного файла, либо все файлы .txt
					  пусты, генерация будет прервана с сообщением "Processing set is empty".
					  
Сохранить в директорию - адрес, по которому будут размещены сгенерированные отчеты.

Сохранить с именем - основная часть имени, под которым будут сохранены отчеты. Помимо основной части,
                     имя включает также постфиксную часть, показывающую "специализацию" отчета.

__________________________________________________________________________________________________
3. Состав отчета

Отчет состоит из двух "подотчетов", с постфиксами "_common" и "_shifts" в имени файла. Все файлы отчетов
состоят из обычных текстовых данных, и сохраняются с расширением .txt
common-отчет - общий по всем собранным в процессе обхода директории-источника сырым данным.
shifts-отчет - посменный, содежит данные разбитые посменно.

__________________________________________________________________________________________________
4. Содержимое отчетов

Каждый текст отчета содержит набор строк, который может немного меняться в зависимости от типа отчета и
настроек.
Назначение строк:

- Report generated at
дата и время генерации отчета в развернутом формате (день недели, месяц, число, время, часовой пояс, год).

- Source: work period between ... and ...
Период времени, в рамках которого собраны данные для создания отчета. Границы периода привязаны не к
границам смен, или какого-то управляемого пользователем периода, а к конкретным деталям из сырых выгрузок.
Таким образом, по этим двум временным меткам при желании всегда можно в сырых данных найти, с какой детали
начался период, и на какой он закончился.

- Mode
Показывает алгоритм, используемый программой для фильтрации входящих данных о времени изготовления деталей.
Может быть трех видов: грубое снижение пиков времени выше максимума до некоторого фиксированного, "умная"
фильтрация входных данных через внутренний репозиторий программы, и отсутствие любой фильтрации

- Total uptime
Общее время, охваченное отчетом, т.е. прошедшее между началом изготовления первой детали и до конца
изготовления последней. Отметим, что это НЕ значит, что машина работала, или даже была включена весь этот
период. Эта величина зависит только от сырых данных отчета.

- Total idle
Общее время, в течение которого внутри периода не выполнялась работа по изготовлению какой-то детали. В
отличие от uptime, это время берется не только из сырых данных, но и модифицируется алгоритмом, в случае
если активирован какой-то из режимов фильтрации.

- Operation time
Время, в течение которого внутри периода выполнялась работа по изготовлению деталей. Аналогично idle-time,
модифицируется фильтрующими алгоритмами.

- Carriage rollbacks (estimated by time gaps)...[(active)]
Оценочное количество откатов каретки, взятое по признаку выявленных в структуре входящего времени периодов
бездействия, свыше заданного (т.е. если какое то время, дольше X, ничего не происходит, то это считается
однократным откатом каретки). Метка (active) обозначает, что этот режим выбран для оценки "делового" времени.

- Carriage rollbacks (estimated by total length)...[(active)]
Оценочное количество откатов каретки, взятое по суммарной длине всего обработанного металлопроката, соотнесенной
с назначенной длиной одной единицы сырья (плети), а также с учетом коэффициента использования металла.
Метка (active) обозначает, что этот режим выбран для оценки "делового" времени.

- Carriage rollbacks (estimated by extra cuts)...[(active)]
Оценочное количество откатов каретки, взятое по анализу количества рубов из сырых данных. Если на какой-либо
детали зафиксировано два руба, этот факт считается границей новой единицы сырья, соответственно для ее захвата
необходим откат каретки, который и учитывается. Оценочно, этот способ наиболее точен. Метка (active) обозначает,
что этот режим выбран для оценки "делового" времени.

- Deal time
Оценочное деловое время. В этот время входит операционное время и время, необходимое для выполнения всех
детектированных откатов каретки. Время одного отката каретки фиксировано, и доступно для настройки.

- Workload, %, by period duration & opTime
Коэффициент загрузки фонда времени, по соотношению длительности охваченного отчетом периода и только операционного
времени (т.е. только того, когда машина фиксировала изготовление деталей, без откатов каретки и прочего).
Отметим особо, что длина периода в этом случае - это НЕ длина смены, а время между крайними во времени деталями
в сырых данных.

- Workload, %, by period duration & deal time
Аналогично предыдущему, но в качестве "полезного" выступает деловое время.

- Workload, %, by shift duration & deal time.
Коэффициент загрузки фонда времени, вычисленный по соотношению длительности смены, заданной в настройках, и
деловому времени. Этот пункт появляется только в сменных отчетах (_shifts), и отсутствует в общем (_common).
ВАЖНО: длину смены задает отдельная величина в настройках, никак не связанная с настраиваемой там же "картой"
разбиения суток на смены. Если изменена карта разбиений, то следует привести в соответствие и длительность смены,
иначе оценка загрузки будет неверной. Отсутствует возможность задать разные длины смен, хотя создать смены
разной длины в карте разбиений - возможно.

Группа "Total amounts" содержит сводку некоторых данных, в основном специфичных для конструкции деталей:

Total holes - всего выполнено отверстий
Total cuts - всего выполнено рубов
Total mass - суммарная масса деталей
Total length - суммарная длина деталей
Total pieces - всего изготовлено деталей

Общий отчет, помимо описанного выше блока, содержит данные о "подозрительных" фактах в отчете. Всего там
два раздела:

Suspicious time wastes (more than ... seconds) - список подозрительно длинных пустых промежутков, в которые
не выполнялось никаких действий.
Структура записи:
{S} seconds gap detected between {T1} and {T2}
S - количество секунд, в течение которых ничего не фиксировалось
T1 - начало промежутка бездействия
T2 - окончание промежутка бездействия
Порог, промежутки врмени всыше которого сюда попадают, доступен из настроек.

Suspicious labours (more than ... seconds) - список подозрительно длительно изготавливаемых деталей.
Структура записи:
{S} processing duration detected for {P} at {T}
S - время изготвления
P - полный список атрибутов детали, идентифицирующий ее
T - время готовности детали

__________________________________________________________________________________________________
5. Настройки

Практически все параметры, с которыми работает программа, могут быть настроены. Для настройки необходимо
перейти в Меню -> Настройки...
В открывшемся окне можно настроить следующие параметры:

- Веремя отката каретки, сек
Это время используется для детектирования откатов каретки, если выбран соответствующий механизм, и, во
всех случаях, используется в составе делового времени, как время единичного отката каретки.

- Подозрительный перерыв, больше чем, сек
Если фиксируется промежуток бездействия, дольше указанного, то запись об этом попадает в список подозрительных
растрат времени (см. раздел 4).

- Подозрительное время обработки, больше чем, сек
Аналогично предыдущему, деталь, время изготовления которой превышает эту величину, будет зафиксирована как
подозрительная. Дополнительно, в случае если выбран грубый режим фильтрации, то время обработки такой детали
будет уменьшенно до заданного фиксированного.

- Адаптировать время выполнения операций
Включает режим фильтрации. Доступно два варианта фильтрации, между которыми можно переключаться радиокнопкой

- Уменьшать подозр. время обработки до, сек
Режим грубой фильтрации. Просто уменьшает любой подохрительный промежуток до величина, заданной на поле справа.

- Использовать внутреннее хранилище данных о времени
Включает режим "умной" фильтрации всех входных данных из сырых отчетов. Краткое описание:
По мере работы программы, данные о времени изготовления разных изделий накапливаются во внутреннем
хранилище (репозитории). Любая изучаемая деталь, если этот режим активен, проверяется в репозитории на
предмет того, встречалась ли она раньше в выгрузках, и если да, то из хранилища берется усредненное по
некоторому ограниченному количеству последних случаев время изготовления. Если текущее рассматриваемое время
превышает время из репозитория НЕ больше, чем в Х раз, то такое время будет признано достоверным, и пойдет в отчет